<!-- <link href="css/shared.css?v=1.0.0.16" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script> -->
<style>
    #profiles-mini {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
    }

    #profiles-mini>div {
        flex: 1 0 28%;
        margin: 0.5em;
        max-width: 28%;
        width: 28%;
        min-width: 28%;
    }

    #profiles-mini .profiles-minicontent {
        background-color: var(--gray-blur-40);
        padding: 1em;
        color: var(--color-dynamic-1);
        box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 3px 0px, rgba(0, 0, 0, 0.06) 0px 1px 2px 0px;
        border-radius: 0.5em;
    }

    #profiles-mini .profiles-minicontent>div:first-child {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding-bottom: 1em;
    }

    #profiles-mini .profiles-minicontent>div:first-child img {
        border-radius: 50%;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        width: 8em;
        height: 8em;
        object-fit: contain;
    }

    #profiles-mini .profiles-minicontent>div:not(:first-child) {
        /* flex: 1; */
        text-align: center;
    }

    #profiles-mini>div>div>div:not(:last-child) {
        padding-bottom: 0.5em;
    }

    #profiles-mini .dvTXT {
        display: flex;
        flex-direction: column;
    }

    #profiles-mini *[name] {
        font-weight: bold;
    }

    #profiles-mini *[name="avatar"] {
        padding: 0 2em;
    }

    #profiles-mini *[name]:not(#profiles-mini *[name="name"], #profiles-mini *[name="avatar"], #profiles-mini *[name="id"]) {
        /* padding-left: 1em; */
        font-size: 0.9em;
    }

    #profiles-mini *[name="name"] {
        font-size: 1.5em;
        text-decoration: underline;
        text-transform: capitalize;
    }

    #profiles-mini *[name="name"]:hover,
    #profiles-mini *[name="avatar"]:hover {
        cursor: pointer;
    }

    #profiles-mini *[name="title"],
    #profiles-mini *[name="position"] {
        color: var(--gray-1);
    }

    #profiles-mini *[name]>a {
        color: var(--gray-1);
        text-decoration: none;
    }

    #profiles-mini *[name]>i {
        margin-right: 0.5em;
        color: var(--gray-1);
    }

    @media only screen and (max-width: 992px) {
        #profiles-mini {
            display: block;
        }

        #profiles-mini>div {
            max-width: 100%;
            width: 100%;
        }

    }
</style>

<div id="profiles-mini" currentpage="1" class="divcontent"></div>

<script>
    // let uri_api = "https://dhqt.api.phuckhanggem.com/";
    // let uri_img = "https://dhqt.phuckhanggem.com/ftp_images/";
    // function getUrlParameter(sParam) {
    //     var sPageURL = window.location.search.substring(1),
    //         sURLVariables = sPageURL.split('&'),
    //         sParameterName,
    //         i;

    //     for (i = 0; i < sURLVariables.length; i++) {
    //         sParameterName = sURLVariables[i].split('=');

    //         if (sParameterName[0] === sParam) {
    //             return typeof sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
    //         }
    //     }
    //     return false;
    // };
    soitem = 10;
    $(function () {
        let lang = localStorage.getItem('lang');
        loadItem($('#profiles-mini').attr('currentpage'), soitem, lang, getUrlParameter("department"), getUrlParameter("position-title"));

        $(window).scroll(function () {
            let height = Math.round($('#profiles-mini').height() - 550);
            var currentScroll = $(this).scrollTop();
            if (currentScroll >= height) {
                let pageload = parseInt($('#profiles-mini').attr('currentpage')) + 1;
                loadItem(pageload, soitem, lang, getUrlParameter("department"), getUrlParameter("position-title"));
                $('#profiles-mini').attr('currentpage', pageload)
            }
            previousScroll = currentScroll;
        });
    });
    function loadItem(sotrang, soitem, lang, department = false, position_title = false) {
        if ($('#profiles-mini').attr("max-page") === undefined) {
            let reqjson = {
                "loai": 8,
                "sotrang": sotrang,
                "soitem": soitem,
                "lang": lang,
            };
            if (department != false) reqjson.department = department;
            if (position_title != false) reqjson.position = position_title;
            $.ajax({
                type: 'POST',
                url: uri_api + "store/StoredProcedure",
                data: JSON.stringify(reqjson),
                dataType: "json",
                contentType: "application/json",
                async: false,
                success: function (su) {
                    if (su.message === "success") {
                        if (su.responses.length > 0) {
                            let keys = Object.keys(su.responses[0]);
                            $.map(su.responses, function (i) {
                                let id = i.id;
                                let avatar = i.avatar;
                                let div = $(`<div name="id" userid="${id}" role="${i.role}" class="profiles-minicontent">`);
                                div.append(`<div name="avatar" userid="${id}"><img src="${uri_img + avatar}" /></div>`);
                                let divtxt = $(`<div class="dvTXT">`);
                                $.map(keys, function (k) {
                                    if (k !== "id" && k !== "avatar" && k !== "role" && k !== "username" && k !== "teachingcourse" && k !== "language" && k !== "education" && k !== "supervision" && k !== "major" && i[k].length > 0 && i[k].toString().indexOf('<p') === -1) {
                                        if (k === "phone")
                                            divtxt.append(`<div name="${k}" userid="${id}"><i class="fa-solid fa-phone"></i><a href="tel:${i[k]}">${i[k]}</a></div>`);
                                        else if (k === "email")
                                            divtxt.append(`<div name="${k}" userid="${id}"><i class="fa-solid fa-envelope"></i><a href="mailto:${i[k]}">${i[k]}</a></div>`);
                                        else if (k === "name")
                                            divtxt.append(`<div name="${k}" userid="${id}">${i[k]}</div>`);
                                        else
                                            divtxt.append(`<div name="${k}" userid="${id}">${i[k]}</div>`);
                                    }
                                });
                                div.append(divtxt);
                                $('#profiles-mini').append(div);
                            });
                        }
                        else
                            $('#profiles-mini').attr("max-page", "true");
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });

            $('#profiles-mini *[name="name"], #profiles-mini *[name="avatar"]').click(function (e) {
                e.stopPropagation();
                let userid = $(this).attr('userid');
                // console.log(userid)
                loadPage("profile-single", false, false, false, false, false, false, userid);
            });
        }
    }
</script>